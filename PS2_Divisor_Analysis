// All Accepted

#include <bits/stdc++.h>
using namespace std;
#define MOD 1000000007
 
long long binpower(long long a,long long n){
    long long res = 1;
    while(n>0)
    {
        if(n%2)
        {
            res=(res*(a)%MOD)%MOD;
        }
        a = (a*a)%MOD;
        n>>=1;
    }
    return res;
}
 
int main() {
    long long n;
    cin >> n;
    long long k[n];
    long long x[n];
    long long ans = 1;
    long long temp = 1;
    long long ans1 = 1;
    long long ans2 = 1;
    long long temp1 = 1;
    long long a = 1;
    int flag = 1;
    for(long long i = 0;i<n;i++)
    {
        cin >> x[i] >> k[i];
        if(k[i]%2)
        {
            flag = 0;
        }
        if(flag)
        {
            temp1 = (temp1*binpower(x[i],(k[i]/2)%(MOD-1)))%MOD;
        }
        ans = (ans*(k[i] + 1)%MOD)%MOD;
        temp = (temp*(k[i] + 1)%(MOD-1))%(MOD-1);
        ans1 = (ans1*(binpower(x[i],k[i] + 1) - 1))%MOD;
        //ans1-=1;
        ans1=(ans1*binpower((x[i]-1),MOD-2))%MOD;
        a = (a*binpower(x[i],k[i]))%MOD;
    }
    if(!flag)
    {
        temp = (temp*(binpower(2,MOD-3))%(MOD-1))%(MOD - 1);
        ans2 = (binpower(a,temp))%MOD;
    }
    else
    {
        temp--;
        temp = (temp*(binpower(2,MOD-3))%(MOD-1))%(MOD - 1);
        ans2 = (binpower(a,temp))%MOD;;
        ans2=(ans2*temp1)%MOD;
    }
    cout << ans << " " << ans1 << " " << ans2;
    
    return 0;
